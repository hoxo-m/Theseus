[{"path":"https://hoxo-m.github.io/TheseusPlot/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Koji Makiyama. Author, maintainer, copyright holder. Shinichi Takayanagi. Medium. Daisuke Ichikawa. Expert. LY Corporation Analytics Solution Enhancement Team. Sponsor.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Makiyama K (2025). TheseusPlot: Visualizing Decomposition Differences Rate Metrics. R package version 0.1.1.9000, https://github.com/hoxo-m/TheseusPlot.","code":"@Manual{,   title = {TheseusPlot: Visualizing Decomposition of Differences in Rate Metrics},   author = {Koji Makiyama},   year = {2025},   note = {R package version 0.1.1.9000},   url = {https://github.com/hoxo-m/TheseusPlot}, }"},{"path":[]},{"path":"https://hoxo-m.github.io/TheseusPlot/index.html","id":"id_1-overview","dir":"","previous_headings":"","what":"1. Overview","title":"Visualizing Decomposition of Differences in Rate Metrics","text":"data analysis, metric differs two groups, sometimes want investigate whether particular subgroup driving difference. example, key metric decline detected compared previous year, may want conduct detailed analysis. analysis, may focus gender among attributes examine whether decline occurred among male, female, . However, type analysis challenging metric rate, magnitude subgroup’s contribution rate simply calculated, unlike case volume metrics. address issue, propose approach inspired story Ship Theseus. approach involves gradually replacing components one group another, recalculating metric step. change metric step can interpreted contribution subgroup overall difference. instance, suppose metric 6.2% 2024 decreased 5.2% 2025. , focus gender. replace male data within 2024 dataset male data 2025 recalculate metric. result, metric drop 0.8 percentage points, reaching 5.4%. case, contribution male group change metric -0.8 percentage points. Next, replace female data 2024 2025. dataset consists entirely 2025 data, metric drops 0.2 percentage points, reaching 5.2%. Thus, contribution female group -0.2 percentage points. visualized, results appear follows:  plot, can see decline metric primarily driven male group. call visualization “Theseus Plot.” TheseusPlot package designed make easy generate Theseus Plots various attributes.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/index.html","id":"id_2-installation","dir":"","previous_headings":"","what":"2. Installation","title":"Visualizing Decomposition of Differences in Rate Metrics","text":"can install TheseusPlot package CRAN. can install development version GitHub :","code":"install.packages(\"TheseusPlot\") remotes::install_github(\"hoxo-m/TheseusPlot\")"},{"path":[]},{"path":"https://hoxo-m.github.io/TheseusPlot/index.html","id":"id_31-prepare-data","dir":"","previous_headings":"3. Details","what":"3.1 Prepare Data","title":"Visualizing Decomposition of Differences in Rate Metrics","text":"create Theseus plots, need two data frames share common columns. use 2013 New York City flight data nycflights13 demo dataset. , define rate metric proportion flights arrived time. December 2013, -time arrival rate dropped substantially compared November. investigate cause using Theseus plot. First, create on_time column data frame indicate whether flight arrived time. Next, extract flights November December separate data frames form two comparison groups. -time arrival rate 64% November dropped 47% December.","code":"library(dplyr) library(nycflights13)  data <- flights |>    filter(!is.na(arr_delay)) |>   mutate(on_time = arr_delay <= 0) |>  # Arrived on time   left_join(airlines, by = \"carrier\") |>   mutate(carrier = name) |>  # Convert carrier abbreviations to full names   select(year, month, day, origin, dest, carrier, dep_delay, on_time)  data |> head() #> # A tibble: 6 × 8 #>    year month   day origin dest  carrier                dep_delay on_time #>   <int> <int> <int> <chr>  <chr> <chr>                      <dbl> <lgl>   #> 1  2013     1     1 EWR    IAH   United Air Lines Inc.          2 FALSE   #> 2  2013     1     1 LGA    IAH   United Air Lines Inc.          4 FALSE   #> 3  2013     1     1 JFK    MIA   American Airlines Inc.         2 FALSE   #> 4  2013     1     1 JFK    BQN   JetBlue Airways               -1 TRUE    #> 5  2013     1     1 LGA    ATL   Delta Air Lines Inc.          -6 TRUE    #> 6  2013     1     1 EWR    ORD   United Air Lines Inc.         -4 FALSE  data_Nov <- data |> filter(month == 11) data_Dec <- data |> filter(month == 12)  data_Nov |> summarise(on_time_rate = mean(on_time)) |> pull(on_time_rate) #> [1] 0.6426161 data_Dec |> summarise(on_time_rate = mean(on_time)) |> pull(on_time_rate) #> [1] 0.4672835"},{"path":"https://hoxo-m.github.io/TheseusPlot/index.html","id":"id_32-basics","dir":"","previous_headings":"3. Details","what":"3.2 Basics","title":"Visualizing Decomposition of Differences in Rate Metrics","text":"Using two prepared data frames, first create ship object. ship object instance R6 class ShipOfTheseus, designed create Theseus plots. can create Theseus plot passing column names plot method ship object. example, create Theseus plot airport origin:  New York City three major airports, Newark Liberty International Airport (EWR) accounted largest share decline -time arrival rate. Note number flights airport matters, larger flight volume expected greater impact. make clear, Theseus plot displays data size group within subgroup bar chart. , see number flights similar across airports, allowing direct comparison contributions. summary, Theseus plot consists two components: waterfall plot showing much subgroup contributed change metric. bar chart representing sample size group within subgroup. ship object also provides table method inspect exact values used Theseus plot.","code":"library(TheseusPlot)  ship <- create_ship(data_Nov, data_Dec, y = on_time, labels = c(\"November\", \"December\")) ship$plot(origin) ship$table(origin) #> # A tibble: 3 × 8 #>   origin contrib    n1    n2    x1    x2 rate1 rate2 #>   <chr>    <dbl> <int> <int> <int> <int> <dbl> <dbl> #> 1 EWR    -0.0831  9603  9410  6251  3901 0.651 0.415 #> 2 JFK    -0.0565  8645  8923  5702  4332 0.660 0.485 #> 3 LGA    -0.0358  8723  8687  5379  4393 0.617 0.506"},{"path":"https://hoxo-m.github.io/TheseusPlot/index.html","id":"id_33-flipping-the-plot","dir":"","previous_headings":"3. Details","what":"3.3 Flipping the Plot","title":"Visualizing Decomposition of Differences in Rate Metrics","text":"many subgroups, Theseus plot can become hard read. cases, can swap x- y-axes better visualization.  number subgroups large, small contributions automatically grouped together. default, happens 10 subgroups, threshold can adjusted n argument.  plot, JetBlue Airways United Air Lines appear largest contributions decline -time arrival rate.","code":"ship$plot_flip(carrier) ship$plot_flip(carrier, n = 5)"},{"path":"https://hoxo-m.github.io/TheseusPlot/index.html","id":"id_34-automatic-discretization-of-continuous-values","dir":"","previous_headings":"3. Details","what":"3.4 Automatic Discretization of Continuous Values","title":"Visualizing Decomposition of Differences in Rate Metrics","text":"Theseus plots directly support continuous variables. continuous column provided, automatically discretized. example, can create Theseus plot departure delays.  default, continuous variables discretized subgroup roughly equal sample sizes, number bins set 10. can modify settings passing return value continuous_config() continuous argument.  result shows decrease -time departures increase delayed departures contributed decline -time arrival rate.","code":"ship$plot_flip(dep_delay) ship$plot_flip(dep_delay, continuous = continuous_config(n = 5))"},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":null,"dir":"Reference","previous_headings":"","what":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"`ShipOfTheseus` class decomposes difference outcome rates two datasets visualizes results Theseus Plot. provides methods compute contributions individual attributes, summarize results tables, generate waterfall-style plots intuitive interpretation.","code":""},{"path":[]},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"ShipOfTheseus$new() ShipOfTheseus$table() ShipOfTheseus$plot() ShipOfTheseus$plot_flip() ShipOfTheseus$clone()","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"constructor ShipOfTheseus class.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"","code":"ShipOfTheseus$new(data1, data2, outcome, labels, ylab, digits, text_size)"},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"data1 data frame representing first group (e.g., baseline \"original\" data). data2 data frame representing second group (e.g., comparison \"refitted\" data). outcome string specifying outcome variable used compute rate metric (default \"y\"). Typically, binary indicator (e.g., 0/1) aggregated form rates. labels character vector length 2 giving labels two groups. first corresponds `data1`, second `data2`. Default c(\"Original\", \"Refitted\"). ylab string specifying y-axis label plots. NULL (default), label displayed. digits integer indicating number decimal places use displaying numeric values (default 3). text_size numeric value specifying relative size text elements plots (default 1).","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"ShipOfTheseus object, can used plot()   create Theseus plots.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"method-table-","dir":"Reference","previous_headings":"","what":"Method table()","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"Generate contribution table given column.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"","code":"ShipOfTheseus$table(column_name, n = Inf, continuous = continuous_config())"},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"column_name string. name column analyze. n integer. Maximum number top contributing attributes display. number attributes exceeds `n`, remaining aggregated. continuous list. configuration list handling continuous variables (e.g., specifying number bins custom breaks).","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"tibble summarizing attribute's contribution   difference two groups, including counts, total outcomes,   rates subgroup.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"method-plot-","dir":"Reference","previous_headings":"","what":"Method plot()","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"Generate Theseus plot specified column","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"","code":"ShipOfTheseus$plot(   column_name,   n = 10L,   main_item = NULL,   bar_max_value = NULL,   levels = NULL,   continuous = continuous_config() )"},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"column_name name column visualize. n integer. Maximum number top contributing attributes display. Remaining attributes aggregated necessary. main_item string. attribute used reference scaling bar heights. bar_max_value numeric. Maximum value scaling contribution bars. levels character vector specifying display order attributes. continuous list. Configuration handling continuous variables (e.g., number bins custom breaks).","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"ggplot object representing Theseus Plot specified column.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"method-plot-flip-","dir":"Reference","previous_headings":"","what":"Method plot_flip()","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"Generate Theseus plot specified column","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"","code":"ShipOfTheseus$plot_flip(   column_name,   n = 10L,   main_item = NULL,   bar_max_value = NULL,   levels = NULL,   continuous = continuous_config() )"},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"column_name name column visualize. n integer. Maximum number top contributing attributes display. Remaining attributes aggregated necessary. main_item string. attribute used reference scaling bar heights. bar_max_value numeric. Maximum value scaling contribution bars. levels character vector specifying display order attributes. continuous list. Configuration handling continuous variables (e.g., number bins custom breaks).","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"ggplot object representing Theseus Plot specified column.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"objects class cloneable method.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"","code":"ShipOfTheseus$clone(deep = FALSE)"},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/ShipOfTheseus.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"An R6 Class for Generating Theseus Plot — ShipOfTheseus","text":"deep Whether make deep clone.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/continuous_config.html","id":null,"dir":"Reference","previous_headings":"","what":"Continuous Variable Configuration for Theseus Plot — continuous_config","title":"Continuous Variable Configuration for Theseus Plot — continuous_config","text":"continuous_config() function creates configuration object handling continuous variables Theseus plots. controls continuous data binned discrete categories contribution calculations visualization.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/continuous_config.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Continuous Variable Configuration for Theseus Plot — continuous_config","text":"","code":"continuous_config(   n = 10L,   pretty = TRUE,   split = c(\"count\", \"width\", \"rate\"),   breaks = NULL )"},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/continuous_config.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Continuous Variable Configuration for Theseus Plot — continuous_config","text":"n integer. Number bins create continuous variable. pretty logical. TRUE, use pretty breaks bin edges. split string. Method binning continuous variables. Options : \"count\" divide variable bins roughly equal number observations. \"width\" divide range variable equal-width bins. \"rate\" divide based differences outcome rates bins. breaks numeric vector specifying custom break points.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/continuous_config.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Continuous Variable Configuration for Theseus Plot — continuous_config","text":"list containing binning parameters (n, pretty,   split, breaks) used plotting contribution   calculations continuous variables.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/continuous_config.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Continuous Variable Configuration for Theseus Plot — continuous_config","text":"","code":"library(TheseusPlot) continuous_config(n = 5, pretty = FALSE, split = \"rate\") #> $n #> [1] 5 #>  #> $pretty #> [1] FALSE #>  #> $split #> [1] \"rate\" #>  #> $breaks #> NULL #>"},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/create_ship.html","id":null,"dir":"Reference","previous_headings":"","what":"Creates a Ship Object for Generating Theseus Plots — create_ship","title":"Creates a Ship Object for Generating Theseus Plots — create_ship","text":"Creates ship object, serves container data methods generate Theseus plots decomposing differences rate metrics.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/create_ship.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creates a Ship Object for Generating Theseus Plots — create_ship","text":"","code":"create_ship(   data1,   data2,   y = \"y\",   labels = c(\"Original\", \"Refitted\"),   ylab = NULL,   digits = 3L,   text_size = 1 )"},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/create_ship.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creates a Ship Object for Generating Theseus Plots — create_ship","text":"data1 data frame representing first group (e.g., baseline \"original\" data). data2 data frame representing second group (e.g., comparison \"refitted\" data). y column name specifying outcome variable used compute rate metric (default \"y\"). Typically, binary indicator (e.g., 0/1) aggregated form rates. labels character vector length 2 giving labels two groups. first corresponds data1, second data2. Default c(\"Original\", \"Refitted\"). ylab string specifying y-axis label plots. NULL (default), label displayed. digits integer indicating number decimal places use displaying numeric values (default 3). text_size numeric value specifying relative size text elements plots (default 1.0).","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/create_ship.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Creates a Ship Object for Generating Theseus Plots — create_ship","text":"ShipOfTheseus object, can used plot()   create Theseus plots.","code":""},{"path":"https://hoxo-m.github.io/TheseusPlot/reference/create_ship.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Creates a Ship Object for Generating Theseus Plots — create_ship","text":"","code":"library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union library(TheseusPlot)  data <- nycflights13::flights |>   filter(!is.na(arr_delay)) |>   mutate(on_time = arr_delay <= 0)  data1 <- data |> filter(month == 1) data2 <- data |> filter(month == 2)  create_ship(data1, data2, y = on_time) #> <ShipOfTheseus> #>   Public: #>     clone: function (deep = FALSE)  #>     initialize: function (data1, data2, outcome, labels, ylab, digits, text_size)  #>     plot: function (column_name, n = 10L, main_item = NULL, bar_max_value = NULL,  #>     plot_flip: function (column_name, n = 10L, main_item = NULL, bar_max_value = NULL,  #>     table: function (column_name, n = Inf, continuous = continuous_config())  #>   Private: #>     compute_contribution: function (column_name, continuous)  #>     compute_info: function (column_name, continuous)  #>     compute_scores: function (column_name)  #>     compute_size: function (column_name, target, continuous)  #>     digits: 3 #>     labels: Original Refitted #>     text_size: 1 #>     to_factor: function (column_name, continuous)  #>     ylab: NULL"},{"path":[]},{"path":"https://hoxo-m.github.io/TheseusPlot/news/index.html","id":"theseusplot-011","dir":"Changelog","previous_headings":"","what":"TheseusPlot 0.1.1","title":"TheseusPlot 0.1.1","text":"CRAN release: 2025-08-28 Initial CRAN submission.","code":""}]
